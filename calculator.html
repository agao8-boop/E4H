<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Calculate Your Savings | E4H Energy</title>
<link href="https://fonts.googleapis.com/css2?family=DM+Serif+Display:ital@0;1&family=DM+Sans:ital,opsz,wght@0,9..40,300;0,9..40,400;0,9..40,500;0,9..40,600;0,9..40,700;1,9..40,400&display=swap" rel="stylesheet">
<style>
  :root {
    --primary: #2D6F5E; --primary-light: #3D8F7E; --accent: #E87461; --accent-light: #FF9B88;
    --green: #2ECC71; --green-soft: #D5F5E3; --off-white: #F7F5F0; --warm-gray: #E8E4DD;
    --text-dark: #1A1A1A; --text-mid: #555555; --text-light: #888888;
    --card-shadow: 0 8px 40px rgba(45,111,94,0.08);
  }

  * { margin: 0; padding: 0; box-sizing: border-box; }
  html { scroll-behavior: smooth; }
  body { font-family: 'DM Sans', sans-serif; background: var(--off-white); color: var(--text-dark); }

  nav { position: fixed; top: 0; width: 100%; z-index: 100; padding: 1rem 2.5rem; display: flex; align-items: center; justify-content: space-between; background: rgba(247,245,240,0.95); backdrop-filter: blur(16px); border-bottom: 1px solid rgba(0,0,0,0.04); }
  .logo { font-family: 'DM Serif Display', serif; font-size: 1.55rem; color: var(--primary); text-decoration: none; }
  .logo span {
    background: linear-gradient(135deg, #E07563 0%, #E99078 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
  }
  .btn-primary { display: inline-block; background: var(--primary); color: #fff; padding: 0.8rem 1.8rem; border-radius: 8px; font-weight: 600; text-decoration: none; transition: all 0.3s ease; box-shadow: 0 2px 8px rgba(45,111,94,0.15); border: none; cursor: pointer; }
  .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(45,111,94,0.25); background: var(--primary-light); }
  .btn-secondary { display: inline-block; background: transparent; color: var(--primary); padding: calc(0.8rem - 2px) calc(1.8rem - 2px); border: 2px solid var(--primary); border-radius: 8px; font-weight: 600; text-decoration: none; transition: all 0.3s ease; }
  .btn-secondary:hover { background: var(--primary); color: #fff; transform: translateY(-2px); box-shadow: 0 6px 20px rgba(45,111,94,0.2); }

  .calculator-hero { padding: 8rem 2.5rem 3rem; max-width: 1400px; margin: 0 auto; text-align: center; }
  .calculator-hero h1 { font-family: 'DM Serif Display', serif; font-size: clamp(2.5rem, 5vw, 4rem); color: var(--primary); margin-bottom: 1rem; }
  .calculator-hero p { font-size: 1.2rem; color: var(--text-mid); max-width: 700px; margin: 0 auto; }

  .calculator-container { max-width: 1400px; margin: 0 auto; padding: 2rem 2.5rem 5rem; display: grid; grid-template-columns: 1fr 400px; gap: 3rem; align-items: start; }

  .calculator-form { background: #fff; border-radius: 24px; padding: 3rem; box-shadow: var(--card-shadow); }
  .step-section { margin-bottom: 3rem; }
  .step-header { display: flex; align-items: center; gap: 1rem; margin-bottom: 1.5rem; }
  .step-number { width: 40px; height: 40px; background: var(--primary); color: #fff; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 700; font-size: 1.2rem; }
  .step-title { font-size: 1.5rem; font-weight: 700; color: var(--primary); }
  .step-subtitle { font-size: 0.95rem; color: var(--text-mid); margin-bottom: 1.5rem; }

  .form-group { margin-bottom: 1.5rem; }
  .form-group label { display: block; font-weight: 600; color: var(--text-dark); margin-bottom: 0.5rem; }
  .form-group input, .form-group select {
    width: 100%;
    padding: 0.9rem;
    border: 2px solid var(--warm-gray);
    border-radius: 8px;
    font-family: inherit;
    font-size: 1rem;
    transition: all 0.3s ease;
  }
  .form-group input:focus, .form-group select:focus {
    outline: none;
    border-color: var(--primary);
    box-shadow: 0 0 0 3px rgba(45,111,94,0.1);
  }

  .appliance-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 1rem; }
  .appliance-option {
    background: var(--warm-gray);
    padding: 1.2rem;
    border-radius: 12px;
    cursor: pointer;
    transition: all 0.3s ease;
    border: 2px solid transparent;
  }
  .appliance-option input[type="checkbox"] { display: none; }
  .appliance-option input[type="checkbox"]:checked + label { border-color: var(--primary); background: var(--green-soft); }
  .appliance-option label {
    cursor: pointer;
    display: block;
  }
  .appliance-option:has(input:checked) {
    background: var(--green-soft);
    border-color: var(--primary);
  }
  .appliance-name { font-weight: 600; color: var(--text-dark); margin-bottom: 0.3rem; }
  .appliance-specs { font-size: 0.85rem; color: var(--text-mid); }

  .usage-sliders { margin-top: 1.5rem; }
  .time-slot { margin-bottom: 1.5rem; }
  .time-label { display: flex; justify-content: space-between; margin-bottom: 0.5rem; font-weight: 600; }
  .time-label .value { color: var(--primary); }
  .slider { width: 100%; height: 8px; border-radius: 4px; background: var(--warm-gray); outline: none; -webkit-appearance: none; }
  .slider::-webkit-slider-thumb { -webkit-appearance: none; width: 24px; height: 24px; border-radius: 50%; background: var(--primary); cursor: pointer; box-shadow: 0 2px 8px rgba(45,111,94,0.3); }
  .slider::-moz-range-thumb { width: 24px; height: 24px; border-radius: 50%; background: var(--primary); cursor: pointer; box-shadow: 0 2px 8px rgba(45,111,94,0.3); border: none; }

  /* Results Panel */
  .results-panel {
    position: sticky;
    top: 100px;
    background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
    color: #fff;
    border-radius: 24px;
    padding: 2.5rem;
    box-shadow: var(--card-shadow);
  }
  .results-panel h2 { font-family: 'DM Serif Display', serif; font-size: 1.8rem; margin-bottom: 2rem; }
  .results-section { margin-bottom: 2rem; padding-bottom: 2rem; border-bottom: 1px solid rgba(255,255,255,0.2); }
  .results-section:last-child { border-bottom: none; }
  .results-section h3 { font-size: 0.9rem; text-transform: uppercase; letter-spacing: 1px; opacity: 0.9; margin-bottom: 1rem; }
  .result-item { display: flex; justify-content: space-between; margin-bottom: 0.8rem; }
  .result-label { opacity: 0.9; }
  .result-value { font-weight: 700; font-size: 1.1rem; }
  .total-savings { background: rgba(255,255,255,0.1); padding: 1.5rem; border-radius: 12px; margin: 1.5rem 0; }
  .total-savings .label { font-size: 0.9rem; opacity: 0.9; margin-bottom: 0.5rem; }
  .total-savings .amount { font-size: 2.5rem; font-weight: 700; }
  .recommended-pack { background: rgba(255,255,255,0.15); padding: 1.5rem; border-radius: 12px; margin-bottom: 1.5rem; }
  .recommended-pack h4 { font-size: 1.1rem; margin-bottom: 0.5rem; }
  .recommended-pack .price { font-size: 1.5rem; font-weight: 700; margin-bottom: 0.5rem; }
  .recommended-pack .payback { opacity: 0.9; font-size: 0.9rem; }
  .results-cta { margin-top: 2rem; }
  .results-cta .btn-primary { width: 100%; text-align: center; padding: 1.2rem; background: var(--accent); }
  .results-cta .btn-primary:hover { background: var(--accent-light); }

  /* Methodology Section */
  .methodology { max-width: 1400px; margin: 3rem auto; padding: 0 2.5rem 5rem; }
  .methodology-content { background: #fff; border-radius: 24px; padding: 3rem; box-shadow: var(--card-shadow); }
  .methodology h2 { font-family: 'DM Serif Display', serif; font-size: 2rem; color: var(--primary); margin-bottom: 2rem; text-align: center; }
  .methodology-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 2rem; }
  .methodology-item { padding: 1.5rem; background: var(--warm-gray); border-radius: 12px; }
  .methodology-item h3 { font-size: 1.1rem; color: var(--primary); margin-bottom: 0.8rem; }
  .methodology-item p { font-size: 0.95rem; color: var(--text-mid); line-height: 1.6; }

  /* MOBILE MENU */
  .hamburger { display: none; background: none; border: none; cursor: pointer; padding: 0.5rem; z-index: 101; }
  .hamburger div { width: 25px; height: 3px; background: var(--primary); margin: 5px 0; transition: 0.3s; border-radius: 2px; }
  .mobile-sidebar { position: fixed; top: 0; right: -100%; width: 280px; height: 100vh; background: #fff; box-shadow: -4px 0 20px rgba(0,0,0,0.1); transition: right 0.3s ease; z-index: 100; padding: 5rem 2rem 2rem; overflow-y: auto; }
  .mobile-sidebar.active { right: 0; }
  .mobile-sidebar a { display: block; padding: 1rem 0; text-decoration: none; color: var(--text-dark); font-weight: 500; border-bottom: 1px solid var(--warm-gray); transition: 0.2s; }
  .mobile-sidebar a:hover { color: var(--primary); padding-left: 0.5rem; }
  .mobile-sidebar .btn-primary, .mobile-sidebar .btn-secondary { margin-top: 1rem; text-align: center; padding: 0.8rem 1.5rem; }
  .sidebar-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 99; display: none; }
  .sidebar-overlay.active { display: block; }

  @media (max-width: 1000px) {
    .calculator-container { grid-template-columns: 1fr; }
    .results-panel { position: static; }
  }

  @media (max-width: 900px) {
    nav > div:nth-child(2) { display: none; }
    nav > div:nth-child(3) { display: none; }
    .hamburger { display: block; }
  }

  /* FOOTER STYLES */
  footer { background: var(--primary); color: #fff; padding: 4rem 2.5rem 2rem; }
  .footer-content { max-width: 1200px; margin: 0 auto; display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 3rem; margin-bottom: 3rem; }
  .footer-column h3 { font-size: 1.2rem; margin-bottom: 1.5rem; font-weight: 700; }
  .footer-column p { font-size: 0.95rem; line-height: 1.6; opacity: 0.9; margin-bottom: 1rem; }
  .footer-column ul { list-style: none; }
  .footer-column ul li { margin-bottom: 0.8rem; }
  .footer-column ul li a { color: #fff; text-decoration: none; opacity: 0.9; transition: 0.3s; }
  .footer-column ul li a:hover { opacity: 1; text-decoration: underline; }
  .footer-signup { display: flex; gap: 0.5rem; margin-top: 1rem; }
  .footer-signup input { flex: 1; padding: 0.8rem; border: none; border-radius: 8px; font-size: 0.9rem; }
  .footer-signup button { padding: 0.8rem 1.5rem; background: var(--accent); border: none; border-radius: 8px; color: #fff; font-weight: 600; cursor: pointer; transition: 0.3s; }
  .footer-signup button:hover { background: var(--accent-light); }
  .footer-bottom { max-width: 1200px; margin: 0 auto; padding-top: 2rem; border-top: 1px solid rgba(255,255,255,0.2); }
  .footer-disclaimer { background: rgba(232,116,97,0.2); padding: 1.5rem; border-radius: 12px; margin-bottom: 2rem; border-left: 4px solid var(--accent); }
  .footer-disclaimer h4 { font-size: 0.9rem; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 0.8rem; display: flex; align-items: center; gap: 0.5rem; }
  .footer-disclaimer p { font-size: 0.85rem; line-height: 1.6; opacity: 0.95; }
  .footer-legal { display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 1rem; font-size: 0.85rem; opacity: 0.8; }
  .footer-legal a { color: #fff; text-decoration: none; margin-left: 1.5rem; }
  .footer-legal a:hover { text-decoration: underline; }
</style>
</head>
<body>
<nav style="display: flex; align-items: center; justify-content: space-between; flex-wrap: wrap;">
  <a href="index.html" class="logo">E4<span>H</span> Energy</a>
  <div style="display: flex; gap: 2rem; align-items: center; flex-wrap: wrap;">
    <a href="index.html#how-it-works" style="text-decoration: none; color: var(--text-dark); font-weight: 500; transition: 0.3s;">How It Works</a>
    <a href="calculator.html" style="text-decoration: none; color: var(--primary); font-weight: 600; transition: 0.3s;">Calculator</a>
    <a href="index.html#benefits" style="text-decoration: none; color: var(--text-dark); font-weight: 500; transition: 0.3s;">Benefits</a>
    <a href="index.html#pricing" style="text-decoration: none; color: var(--text-dark); font-weight: 500; transition: 0.3s;">Pricing</a>
    <a href="b2b.html" style="text-decoration: none; color: var(--text-dark); font-weight: 500; transition: 0.3s;">B2B Partnership</a>
  </div>
  <div style="display: flex; gap: 1rem; align-items: center;">
    <a href="mailto:contact@e4henergy.com" class="btn-secondary">Contact Us</a>
    <a href="signup.html" class="btn-primary">I'm Interested</a>
  </div>
  <button class="hamburger" onclick="toggleMobileMenu()">
    <div></div>
    <div></div>
    <div></div>
  </button>
</nav>

<!-- Mobile Sidebar -->
<div class="sidebar-overlay" onclick="toggleMobileMenu()"></div>
<div class="mobile-sidebar" id="mobileSidebar">
  <a href="index.html#how-it-works" onclick="toggleMobileMenu()">How It Works</a>
  <a href="calculator.html" onclick="toggleMobileMenu()">Calculator</a>
  <a href="index.html#benefits" onclick="toggleMobileMenu()">Benefits</a>
  <a href="index.html#pricing" onclick="toggleMobileMenu()">Pricing</a>
  <a href="b2b.html">B2B Partnership</a>
  <a href="mailto:contact@e4henergy.com" class="btn-secondary">Contact Us</a>
  <a href="signup.html" class="btn-primary">I'm Interested</a>
</div>

<div class="calculator-hero">
  <h1>Calculate Your Savings</h1>
  <p>Get a personalized estimate based on your actual usage and local electricity rates</p>
</div>

<div class="calculator-container">
  <div class="calculator-form">
    <!-- Step 1: Location -->
    <div class="step-section">
      <div class="step-header">
        <div class="step-number">1</div>
        <h2 class="step-title">Location</h2>
      </div>
      <p class="step-subtitle">Help us determine your local electricity rates</p>

      <div class="form-group">
        <label>Zip Code</label>
        <input type="text" id="zipcode" placeholder="e.g., 95110" maxlength="5">
      </div>

      <div class="form-group">
        <label>Utility Provider</label>
        <select id="utility">
          <option value="">Select your utility...</option>
          <option value="svce">Silicon Valley Clean Energy</option>
          <option value="sjce">San Jose Clean Energy</option>
          <option value="ebce">East Bay Community Energy</option>
          <option value="pge">PG&E</option>
          <option value="other">Other</option>
        </select>
      </div>
    </div>

    <!-- Step 2: Appliances -->
    <div class="step-section">
      <div class="step-header">
        <div class="step-number">2</div>
        <h2 class="step-title">Appliances</h2>
      </div>
      <p class="step-subtitle">Select which appliances you'd power with E4H batteries</p>

      <div class="appliance-grid">
        <div class="appliance-option">
          <input type="checkbox" id="coffee" data-watts="1000" data-mins="10">
          <label for="coffee">
            <div class="appliance-name">‚òï Coffee Maker</div>
            <div class="appliance-specs">1000W, ~10 min/day</div>
          </label>
        </div>

        <div class="appliance-option">
          <input type="checkbox" id="kettle" data-watts="1500" data-mins="5">
          <label for="kettle">
            <div class="appliance-name">ü´ñ Electric Kettle</div>
            <div class="appliance-specs">1500W, ~5 min/day</div>
          </label>
        </div>

        <div class="appliance-option">
          <input type="checkbox" id="toaster" data-watts="1200" data-mins="5">
          <label for="toaster">
            <div class="appliance-name">üçû Toaster</div>
            <div class="appliance-specs">1200W, ~5 min/day</div>
          </label>
        </div>

        <div class="appliance-option">
          <input type="checkbox" id="airfryer" data-watts="1500" data-mins="20">
          <label for="airfryer">
            <div class="appliance-name">üçü Air Fryer</div>
            <div class="appliance-specs">1500W, ~20 min/day</div>
          </label>
        </div>

        <div class="appliance-option">
          <input type="checkbox" id="rice" data-watts="700" data-mins="45">
          <label for="rice">
            <div class="appliance-name">üçö Rice Cooker</div>
            <div class="appliance-specs">700W, ~45 min/day</div>
          </label>
        </div>

        <div class="appliance-option">
          <input type="checkbox" id="slowcooker" data-watts="200" data-mins="240">
          <label for="slowcooker">
            <div class="appliance-name">üç≤ Slow Cooker</div>
            <div class="appliance-specs">200W, ~4 hrs/day</div>
          </label>
        </div>

        <div class="appliance-option">
          <input type="checkbox" id="microwave" data-watts="1200" data-mins="10">
          <label for="microwave">
            <div class="appliance-name">üì¶ Microwave</div>
            <div class="appliance-specs">1200W, ~10 min/day</div>
          </label>
        </div>

        <div class="appliance-option">
          <input type="checkbox" id="heater" data-watts="1500" data-mins="120">
          <label for="heater">
            <div class="appliance-name">üî• Portable Heater</div>
            <div class="appliance-specs">1500W, ~2 hrs/day</div>
          </label>
        </div>
      </div>
    </div>

    <!-- Step 3: Usage Patterns -->
    <div class="step-section">
      <div class="step-header">
        <div class="step-number">3</div>
        <h2 class="step-title">Usage Patterns</h2>
      </div>
      <p class="step-subtitle">When do you typically use these appliances?</p>

      <div class="usage-sliders">
        <div class="time-slot">
          <div class="time-label">
            <span>üåÖ Morning (6-10 AM)</span>
            <span class="value" id="morningValue">50%</span>
          </div>
          <input type="range" id="morning" class="slider" min="0" max="100" value="50">
        </div>

        <div class="time-slot">
          <div class="time-label">
            <span>‚òÄÔ∏è Afternoon (10 AM-4 PM)</span>
            <span class="value" id="afternoonValue">20%</span>
          </div>
          <input type="range" id="afternoon" class="slider" min="0" max="100" value="20">
        </div>

        <div class="time-slot">
          <div class="time-label">
            <span>üåÜ Evening (4-9 PM)</span>
            <span class="value" id="eveningValue">25%</span>
          </div>
          <input type="range" id="evening" class="slider" min="0" max="100" value="25">
          <p style="font-size: 0.85rem; color: var(--accent); margin-top: 0.5rem;">‚ö° Highest savings potential - peak rates</p>
        </div>

        <div class="time-slot">
          <div class="time-label">
            <span>üåô Night (9 PM-6 AM)</span>
            <span class="value" id="nightValue">5%</span>
          </div>
          <input type="range" id="night" class="slider" min="0" max="100" value="5">
        </div>
      </div>
    </div>

    <!-- Step 4: Current Bill -->
    <div class="step-section">
      <div class="step-header">
        <div class="step-number">4</div>
        <h2 class="step-title">Current Bill</h2>
      </div>
      <p class="step-subtitle">Optional, but helps improve accuracy</p>

      <div class="form-group">
        <label>Monthly Electricity Bill (Optional)</label>
        <input type="number" id="currentBill" placeholder="$120">
      </div>

      <div class="form-group">
        <label>Household Size</label>
        <select id="householdSize">
          <option value="1">1 person</option>
          <option value="2" selected>2 people</option>
          <option value="3">3 people</option>
          <option value="4">4 people</option>
          <option value="5">5+ people</option>
        </select>
      </div>
    </div>
  </div>

  <!-- Results Panel (Sticky) -->
  <div class="results-panel">
    <h2>Your Savings Estimate</h2>

    <div class="results-section">
      <h3>Monthly Savings Breakdown</h3>
      <div class="result-item">
        <span class="result-label">Time-of-Use Optimization:</span>
        <span class="result-value" id="touSavings">$12-18</span>
      </div>
      <div class="result-item">
        <span class="result-label">VPP Event Participation:</span>
        <span class="result-value" id="vppEarnings">$4-8</span>
      </div>
    </div>

    <div class="total-savings">
      <div class="label">Total Monthly Savings:</div>
      <div class="amount" id="monthlySavings">$16-26</div>
      <div class="label" style="margin-top: 1rem;">Annual Savings:</div>
      <div class="amount" style="font-size: 2rem;" id="annualSavings">$192-312</div>
    </div>

    <div class="results-section">
      <h3>Recommended System</h3>
      <div class="recommended-pack">
        <h4 id="recommendedName">Home Pack</h4>
        <div class="price" id="recommendedPrice">$199</div>
        <div class="payback">Payback Period: <strong id="paybackPeriod">8-12 months</strong></div>
      </div>
    </div>

    <div class="results-section">
      <h3>Carbon Impact</h3>
      <div class="result-item">
        <span class="result-label">CO‚ÇÇ Saved/Year:</span>
        <span class="result-value" id="co2Saved">420 kg</span>
      </div>
      <div class="result-item">
        <span class="result-label">Equivalent to:</span>
        <span class="result-value" id="treesEquiv">47 trees planted</span>
      </div>
    </div>

    <div class="results-cta">
      <a href="signup.html" class="btn-primary">Join the Waitlist ‚Üí</a>
      <button class="btn-primary" style="margin-top: 1rem; background: rgba(255,255,255,0.2);" onclick="window.print()">Save Results (PDF)</button>
    </div>
  </div>
</div>

<!-- Methodology Section -->
<div class="methodology">
  <div class="methodology-content">
    <h2>How We Calculate This</h2>
    <div class="methodology-grid">
      <div class="methodology-item">
        <h3>üìä Rate Structure</h3>
        <p style="font-size: 1.3rem; font-weight: 700; color: var(--primary); margin: 0.5rem 0;">$0.15 ‚Üí $0.60/kWh</p>
        <p style="font-size: 0.85rem; margin: 0;">Off-peak to peak pricing</p>
      </div>

      <div class="methodology-item">
        <h3>‚ö° Energy Formula</h3>
        <p style="font-size: 1.1rem; font-weight: 600; color: var(--text-dark); margin: 0.5rem 0;">kWh = (Watts √ó Hours) √∑ 1000</p>
        <p style="font-size: 0.85rem; margin: 0;">Based on EPA/DOE data</p>
      </div>

      <div class="methodology-item">
        <h3>üí∞ VPP Earnings</h3>
        <p style="font-size: 1.3rem; font-weight: 700; color: var(--primary); margin: 0.5rem 0;">$2-5 √ó 15-40 events</p>
        <p style="font-size: 0.85rem; margin: 0;">California DR programs</p>
      </div>

      <div class="methodology-item">
        <h3>üîã Efficiency</h3>
        <p style="font-size: 1.3rem; font-weight: 700; color: var(--primary); margin: 0.5rem 0;">90% round-trip</p>
        <p style="font-size: 0.85rem; margin: 0;">LFP battery standard</p>
      </div>

      <div class="methodology-item">
        <h3>üìà Savings</h3>
        <p style="font-size: 1.1rem; font-weight: 600; color: var(--text-dark); margin: 0.5rem 0;">(Peak rate - Off-peak) √ó kWh</p>
        <p style="font-size: 0.85rem; margin: 0;">Time-shift optimization</p>
      </div>

      <div class="methodology-item">
        <h3>üå± Carbon Impact</h3>
        <p style="font-size: 1.3rem; font-weight: 700; color: var(--primary); margin: 0.5rem 0;">~200g CO‚ÇÇ/kWh</p>
        <p style="font-size: 0.85rem; margin: 0;">CA grid intensity</p>
      </div>
    </div>
  </div>
</div>

<script>
  // Mobile menu toggle
  function toggleMobileMenu() {
    const sidebar = document.getElementById('mobileSidebar');
    const overlay = document.querySelector('.sidebar-overlay');
    sidebar.classList.toggle('active');
    overlay.classList.toggle('active');
  }

  // Rate structures for different utilities (simplified)
  const rateStructures = {
    'svce': { offPeak: 0.15, midPeak: 0.28, peak: 0.52 },
    'sjce': { offPeak: 0.15, midPeak: 0.27, peak: 0.50 },
    'ebce': { offPeak: 0.16, midPeak: 0.29, peak: 0.54 },
    'pge': { offPeak: 0.17, midPeak: 0.30, peak: 0.60 },
    'other': { offPeak: 0.16, midPeak: 0.28, peak: 0.52 }
  };

  // Update slider values
  document.querySelectorAll('.slider').forEach(slider => {
    slider.addEventListener('input', (e) => {
      const id = e.target.id;
      const value = e.target.value;
      document.getElementById(`${id}Value`).textContent = `${value}%`;
      calculateSavings();
    });
  });

  // Calculate savings when inputs change
  document.querySelectorAll('input, select').forEach(input => {
    input.addEventListener('change', calculateSavings);
    input.addEventListener('input', calculateSavings);
  });

  function calculateSavings() {
    // Get selected appliances
    const appliances = [];
    document.querySelectorAll('.appliance-option input:checked').forEach(checkbox => {
      appliances.push({
        watts: parseInt(checkbox.dataset.watts),
        mins: parseInt(checkbox.dataset.mins)
      });
    });

    if (appliances.length === 0) return;

    // Get usage patterns
    const morning = parseInt(document.getElementById('morning').value) / 100;
    const afternoon = parseInt(document.getElementById('afternoon').value) / 100;
    const evening = parseInt(document.getElementById('evening').value) / 100;
    const night = parseInt(document.getElementById('night').value) / 100;

    // Get utility rates
    const utility = document.getElementById('utility').value || 'other';
    const rates = rateStructures[utility];

    // Calculate total daily energy consumption (kWh)
    let totalDailyKwh = 0;
    appliances.forEach(app => {
      const kwhPerUse = (app.watts * (app.mins / 60)) / 1000;
      totalDailyKwh += kwhPerUse;
    });

    // Calculate cost without E4H (assuming usage at different times)
    const costWithoutE4H = (
      totalDailyKwh * morning * rates.midPeak +
      totalDailyKwh * afternoon * rates.midPeak +
      totalDailyKwh * evening * rates.peak +
      totalDailyKwh * night * rates.offPeak
    );

    // Calculate cost with E4H (battery charges off-peak, discharges during use)
    const costWithE4H = totalDailyKwh * rates.offPeak * 1.11; // 1.11 accounts for 90% efficiency

    // Daily savings
    const dailySavings = Math.max(0, costWithoutE4H - costWithE4H);
    const monthlySavings = dailySavings * 30;

    // VPP earnings (estimate based on system size)
    const totalCapacityNeeded = (totalDailyKwh * Math.max(morning, afternoon, evening, night));
    const vppMonthly = totalCapacityNeeded > 0.8 ? 8 : (totalCapacityNeeded > 0.4 ? 6 : 4);
    const vppAnnual = vppMonthly * 12;

    // Total savings
    const totalMonthly = monthlySavings + vppMonthly;
    const totalAnnual = totalMonthly * 12;

    // Recommend system
    let recommendedSystem, systemPrice, payback;
    if (appliances.length <= 2 || totalCapacityNeeded < 0.3) {
      recommendedSystem = 'Starter Pack';
      systemPrice = 99;
      payback = '9-12 months';
    } else if (appliances.length <= 4 || totalCapacityNeeded < 1.0) {
      recommendedSystem = 'Home Pack';
      systemPrice = 199;
      payback = '8-10 months';
    } else {
      recommendedSystem = 'Power Pack';
      systemPrice = 299;
      payback = '6-9 months';
    }

    // Calculate CO2 savings (rough estimate)
    const annualKwh = totalDailyKwh * 365;
    const co2Saved = Math.round(annualKwh * 0.2 * 0.7); // 200g CO2/kWh, 70% reduction during peak
    const treesEquiv = Math.round(co2Saved / 9); // ~9kg CO2 per tree per year

    // Update UI
    document.getElementById('touSavings').textContent = `$${Math.round(monthlySavings)}-${Math.round(monthlySavings * 1.2)}`;
    document.getElementById('vppEarnings').textContent = `$${vppMonthly}`;
    document.getElementById('monthlySavings').textContent = `$${Math.round(totalMonthly)}-${Math.round(totalMonthly * 1.2)}`;
    document.getElementById('annualSavings').textContent = `$${Math.round(totalAnnual)}-${Math.round(totalAnnual * 1.2)}`;
    document.getElementById('recommendedName').textContent = recommendedSystem;
    document.getElementById('recommendedPrice').textContent = `$${systemPrice}`;
    document.getElementById('paybackPeriod').textContent = payback;
    document.getElementById('co2Saved').textContent = `${co2Saved} kg`;
    document.getElementById('treesEquiv').textContent = `${treesEquiv} trees planted`;

    // Track calculator usage
    trackCalculatorUsage({
      appliancesCount: appliances.length,
      totalKwh: totalDailyKwh.toFixed(2),
      morningUsage: Math.round(morning * 100),
      afternoonUsage: Math.round(afternoon * 100),
      eveningUsage: Math.round(evening * 100),
      nightUsage: Math.round(night * 100),
      utility: utility,
      monthlySavings: Math.round(totalMonthly),
      vppEarnings: vppMonthly,
      recommendedSystem: recommendedSystem,
      systemPrice: systemPrice,
      paybackPeriod: payback
    });
  }

  // Track calculator usage
  function trackCalculatorUsage(data) {
    const scriptURL = 'https://script.google.com/macros/s/AKfycbxOqfFuqTr0tcxawTEDb49uqD4f8waVV7fY2uMZBAFBNUwkFw9nNrAl4ZG54QhsqWwM2A/exec';
    const formData = new FormData();
    formData.append('tracking_type', 'calculator');
    formData.append('user_session', getSessionId());
    formData.append('appliances_count', data.appliancesCount);
    formData.append('total_kwh', data.totalKwh);
    formData.append('morning_usage', data.morningUsage);
    formData.append('afternoon_usage', data.afternoonUsage);
    formData.append('evening_usage', data.eveningUsage);
    formData.append('night_usage', data.nightUsage);
    formData.append('utility', data.utility);
    formData.append('monthly_savings', data.monthlySavings);
    formData.append('vpp_earnings', data.vppEarnings);
    formData.append('recommended_system', data.recommendedSystem);
    formData.append('system_price', data.systemPrice);
    formData.append('payback_period', data.paybackPeriod);

    fetch(scriptURL, {
      method: 'POST',
      body: formData,
      mode: 'no-cors'
    }).catch(err => console.log('Tracking error:', err));
  }

  // Generate or retrieve session ID
  function getSessionId() {
    let sessionId = sessionStorage.getItem('e4h_session_id');
    if (!sessionId) {
      sessionId = 'session_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
      sessionStorage.setItem('e4h_session_id', sessionId);
    }
    return sessionId;
  }

  // Initial calculation
  calculateSavings();
</script>

<!-- FOOTER -->
<footer>
  <div class="footer-content">
    <div class="footer-column">
      <div class="logo" style="color: #fff; margin-bottom: 1rem;">E4<span>H</span> Energy</div>
      <p>Making every appliance smarter, cheaper, and cleaner</p>
    </div>

    <div class="footer-column">
      <h3>Company</h3>
      <ul>
        <li><a href="index.html#how-it-works">How It Works</a></li>
        <li><a href="index.html#benefits">Benefits</a></li>
        <li><a href="index.html#pricing">Pricing</a></li>
        <li><a href="calculator.html">Calculator</a></li>
        <li><a href="b2b.html">B2B Partnership</a></li>
      </ul>
    </div>

    <div class="footer-column">
      <h3>Resources</h3>
      <ul>
        <li><a href="calculator.html">Savings Calculator</a></li>
        <li><a href="#">FAQs (Coming Soon)</a></li>
        <li><a href="#">Blog (Coming Soon)</a></li>
        <li><a href="#">Partner Utilities (Coming Soon)</a></li>
      </ul>
    </div>

    <div class="footer-column">
      <h3>Stay Connected</h3>
      <p>Get energy-saving tips and launch updates</p>
      <div class="footer-signup">
        <input type="email" id="footerEmail" placeholder="Your email">
        <button onclick="subscribeNewsletter()">Subscribe</button>
      </div>
      <p id="subscribeMessage" style="font-size: 0.85rem; margin-top: 0.5rem; opacity: 0.9; display: none;"></p>
    </div>
  </div>

  <div class="footer-bottom">
    <div class="footer-disclaimer">
      <h4>‚ö†Ô∏è IMPORTANT DISCLAIMER</h4>
      <p>E4H battery systems are currently in development and not yet available for purchase. All product specifications, pricing, and savings estimates are based on prototypes and projections. This website is for informational purposes only to gauge market interest. We are working on proof-of-concept and expect to launch pilot programs later in 2026. Actual product features and performance may vary.</p>
    </div>

    <div class="footer-legal">
      <div>¬© 2026 E4H Integrated Energy Systems. All rights reserved.</div>
      <div>
        <a href="#">Privacy Policy (Coming Soon)</a>
        <a href="#">Terms of Service (Coming Soon)</a>
        <a href="#">Cookie Settings (Coming Soon)</a>
      </div>
    </div>
  </div>
</footer>

<script>
  // Newsletter subscription function
  function subscribeNewsletter() {
    const email = document.getElementById('footerEmail').value;
    const messageEl = document.getElementById('subscribeMessage');
    const scriptURL = 'https://script.google.com/macros/s/AKfycbxOqfFuqTr0tcxawTEDb49uqD4f8waVV7fY2uMZBAFBNUwkFw9nNrAl4ZG54QhsqWwM2A/exec';

    if (!email || !email.includes('@')) {
      messageEl.style.display = 'block';
      messageEl.style.color = '#E74C3C';
      messageEl.textContent = 'Please enter a valid email address';
      return;
    }

    const formData = new FormData();
    formData.append('email', email);
    formData.append('newsletter', 'yes');

    fetch(scriptURL, {
      method: 'POST',
      body: formData,
      mode: 'no-cors'
    })
    .then(() => {
      messageEl.style.display = 'block';
      messageEl.style.color = '#2ECC71';
      messageEl.textContent = '‚úì Thanks for subscribing!';
      document.getElementById('footerEmail').value = '';
    })
    .catch(error => {
      messageEl.style.display = 'block';
      messageEl.style.color = '#E74C3C';
      messageEl.textContent = 'Error. Please try again.';
    });
  }
</script>

</body>
</html>
